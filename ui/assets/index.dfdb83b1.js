import{d as e,g as s}from"./vendor.194c4086.js";import{b as r}from"./bus.d56574c1.js";e.defaults.withCredentials=!0;let o=localStorage.getItem("language_clup");e.interceptors.request.use((function(e){return e.headers.language_clup=o,e}),(function(e){return Promise.reject(e)})),e.interceptors.response.use((function(e){let s=window.location.href.split("?")[1];return new URLSearchParams(s).has("token")?r.$emit("Permission_repu",!0):r.$emit("Permission_repu",!1),e}),(function(e){if(e.response){if(401===e.response.status){console.log("should logout!!!");let o=window.location.href.split("?")[1];return new URLSearchParams(o).has("token")?window.parent.postMessage("loginout","*"):r.$emit("goto","/login"),s.exports.Message.info({showClose:!0,message:"登录已过期!",duration:2e3}),Promise.reject(e)}if(console.log("axios.interceptors.response.use: "+e),400===e.response.status&&"invalid user name or password!"==e.response.data)return Promise.reject(e);if(400===e.response.status&&(1==e.response.data.err_code||2==e.response.data.err_code)&&-1!=e.response.request.responseURL.indexOf("/api/v1/login"))return s.exports.Message.error({showClose:!0,message:window.vm.$t("verificationRules.yonghuming-huomima-cuowu"),duration:2e3}),Promise.reject(e);if(400===e.response.status&&-1!=e.response.request.responseURL.indexOf("api/v1/unshare_esdisk"))return s.exports.Message.error({showClose:!0,message:e.response.data,duration:5e3,dangerouslyUseHTMLString:!0}),Promise.reject(e);s.exports.Message.error({showClose:!0,message:e.response.data,duration:5e3})}else s.exports.Message.error({showClose:!0,message:e.toString(),duration:5e3});return Promise.reject(e)}));const t=(s,r)=>e.post(s,r).then((e=>e.data));export{t as P};
